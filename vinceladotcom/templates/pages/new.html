{% extends "base.html" %}

{% block more_head %}
<link href="{{ url_for('static', filename='theme/css/one-column.css') }}" rel='stylesheet' type='text/css'>

<style type="text/css">
    .title-big {
        background:
            linear-gradient(to bottom,
                            rgba(41, 41, 41, 0.2) 0%,
                            rgba(41, 41, 41, 0.2)),
            url('/static/images/june_lake_boi.jpg');
        background-size: 100vw;
        background-blend-mode: saturation;
    }
    
    #editor {
        width: 100%;
        height: 70vh;
        
        textarea {
            width: 100%;
            height: 50vh;        
        }
    }
    
    textarea#content {
        display: none;
    }
    
    label {
        display: block;
    }
    
    label input {
        width: 80%;
        float: right;
    }
</style>
{% endblock %}

{% block title_class %}title-big{% endblock %}
{% block title %}Pages{% endblock %}
{% block page_title %}Pages{% endblock %}

{% block content %}
    <h2>Edit Page</h2>
    <form action="{{ target }}" method="post">
        {{ form.csrf}}
        
        <label>
            Title: {{ form.page_title }}
        </label>
        
        <label>
            Template: {{ form.template }}
        </label>
        
        <label>
            URL: {{ form.url }}
        </label>
        
        {{ form.content }}
        
        <div id="editor">&lt;h1&gt;Title&lt;/h1&gt;</div>
            
        <script src="/static/js/ace-builds/src-noconflict/ace.js" type="text/javascript" charset="utf-8"></script>
        <script>
            var editor = ace.edit("editor");
            editor.setTheme("ace/theme/monokai");
            editor.session.setMode("ace/mode/html");
            
            <!-- Hack: Swap contents of content and ACE editor -->
            var html_code = document.getElementById("content").value;
            editor.setValue(html_code);
            editor.clearSelection();
            
            editor.session.on('change', function(delta) {
                document.getElementById("content").value = editor.getValue();
            });
        </script>
    
    {{ form.submit }} {{ form.preview }}
    </form>
    
    {% if preview %}
    <h2>Preview</h2>
    {{ preview|safe }}
    {% endif %}
{% endblock %}